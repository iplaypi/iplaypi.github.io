<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><script src="/lib/pace/pace.min.js?v=1.0.2"></script><link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-240x240-playpi.png?v=5.1.3"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-playpi.png?v=5.1.3"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-playpi.png?v=5.1.3"><link rel="mask-icon" href="/images/logo-playpi.svg?v=5.1.3" color="#222"><meta name="keywords" content="Vultr,Shadowsocks,SS,VPS,搭梯子,梯子搭建,翻墙工具,影梭"><link rel="alternate" href="/atom.xml" title="虾丸派" type="application/atom+xml"><meta name="description" content="本文讲述通过 Vultr 云主机搭建 Shadowsocks 的过程，图文并茂，非常详细。当然，关于云主机有很多 VPS 都可以选择，例如 搬瓦工 、Godaddy、Vultr，读者可以根据价格、配置、地区、操作系统等因素自由选择，但我还是推荐 Vultr，因为它扣费灵活、主机管理灵活、价格优惠，并且还支持支付宝和微信支付，简直太方便了。声明 ：2019 年 08 月 09 日发现 Vultr 官"><meta name="keywords" content="Vultr,Shadowsocks,SS,VPS,搭梯子,梯子搭建,翻墙工具,影梭"><meta property="og:type" content="article"><meta property="og:title" content="使用 Vultr 搭建 Shadowsocks（VPS 搭建 SS）"><meta property="og:url" content="https://www.playpi.org/2018111601.html"><meta property="og:site_name" content="虾丸派"><meta property="og:description" content="本文讲述通过 Vultr 云主机搭建 Shadowsocks 的过程，图文并茂，非常详细。当然，关于云主机有很多 VPS 都可以选择，例如 搬瓦工 、Godaddy、Vultr，读者可以根据价格、配置、地区、操作系统等因素自由选择，但我还是推荐 Vultr，因为它扣费灵活、主机管理灵活、价格优惠，并且还支持支付宝和微信支付，简直太方便了。声明 ：2019 年 08 月 09 日发现 Vultr 官"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa31ivc8mj21hc0mhdh5.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3g9phq7j21hc0jb405.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3h3eeyaj210k04edfx.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3il37mlj20ka074dfy.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3hxmaftj20jd04zmx6.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3j16ymwj20hf03eglj.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/2019/20190507000812.png"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3pjtymuj20g60dp75k.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3ly1fxbhx6e12jj20h004qgln.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbo5moanxj20cj0a5dga.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbo6rej96j20ip0axjs7.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbo7ifow9j20j80apt9k.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbof33m9dj20ij0aa0tl.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxboiacqtbj20se0kojse.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbooa2ikvj20xc0pwq93.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbp79ywuej21hc0q20v7.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1g0pzdu7hdhj20u01me0xa.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1g0pzebvxr7j20u01mcae9.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1g0pzegquf2j20u01jc0wu.jpg"><meta property="og:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa0mkrws7j20pc0nkglz.jpg"><meta property="og:updated_time" content="2018-11-16T11:25:52.000Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="使用 Vultr 搭建 Shadowsocks（VPS 搭建 SS）"><meta name="twitter:description" content="本文讲述通过 Vultr 云主机搭建 Shadowsocks 的过程，图文并茂，非常详细。当然，关于云主机有很多 VPS 都可以选择，例如 搬瓦工 、Godaddy、Vultr，读者可以根据价格、配置、地区、操作系统等因素自由选择，但我还是推荐 Vultr，因为它扣费灵活、主机管理灵活、价格优惠，并且还支持支付宝和微信支付，简直太方便了。声明 ：2019 年 08 月 09 日发现 Vultr 官"><meta name="twitter:image" content="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa31ivc8mj21hc0mhdh5.jpg"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.3",sidebar:{position:"left",display:"hide",offset:12,b2t:!1,scrollpercent:!0,onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="https://www.playpi.org/2018111601.html"><title>使用 Vultr 搭建 Shadowsocks（VPS 搭建 SS） | 虾丸派</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">虾丸派</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">烂笔头</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于</a></li><li class="menu-item menu-item-books"><a href="/books/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i><br>书籍</a></li><li class="menu-item menu-item-guide"><a href="/guide/" rel="section"><i class="menu-item-icon fa fa-fw fa-location-arrow"></i><br>指南</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i> </span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"><input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="https://www.playpi.org/2018111601.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="虾丸派"><meta itemprop="description" content="记录知识 | 分享技术"><meta itemprop="image" content="/images/favicon-1536x1536-playpi.png"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="虾丸派"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">使用 Vultr 搭建 Shadowsocks（VPS 搭建 SS）</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-16T19:25:52+08:00">2018-11-16 </time></span><span id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-divider">|</span> 阅读次数 <span id="busuanzi_value_page_pv"></span></span><div class="post-wordcount"><span class="post-meta-item-text">字数统计</span> <span title="字数统计">5,440字 </span><span class="post-meta-divider">|</span> <span class="post-meta-item-text">阅读时长 &asymp;</span> <span title="阅读时长">20分钟</span></div></div></header><div class="post-body" itemprop="articleBody"><p>本文讲述通过 <code>Vultr</code> 云主机搭建 <code>Shadowsocks</code> 的过程，图文并茂，非常详细。当然，关于云主机有很多 <code>VPS</code> 都可以选择，例如 <strong>搬瓦工 </strong>、<strong>Godaddy</strong>、<strong>Vultr</strong>，读者可以根据价格、配置、地区、操作系统等因素自由选择，但我还是推荐 <code>Vultr</code>，因为它扣费灵活、主机管理灵活、价格优惠，并且还支持支付宝和微信支付，简直太方便了。</p><p><strong>声明 </strong>：2019 年 08 月 09 日发现 <code>Vultr</code> 官方不会再赠送 <code>$10</code> 的代金券给新注册用户，只会给我发放代金券，但是 <code>$25</code> 的代金券仍然有效，请读者选择 <code>$25</code> 对应的链接打开注册，以免错失了代金券。</p><a id="more"></a><h1 id="主机购买"><a href="# 主机购买" class="headerlink" title="主机购买"></a>主机购买</h1><p>使用 <code>Vultr</code> 的云主机，最好选择洛杉矶地区的或者日本的服务器，我亲自测试这两个地区的服务器最稳定，已经推荐给很多人，而且网速相对来说较好，我的推广链接【可以获取 10 美元的代金券，只要充值 10 美元就能使用】：<a href="https://www.vultr.com/?ref=7443790" target="_blank" rel="noopener">我的 10 美元推广链接 </a>，官网链接也在这里：<a href="https://my.vultr.com" target="_blank" rel="noopener">Vultr</a> 。</p><p>这里再多说点，如果使用上面的推广链接注册 <code>Vultr</code> 帐号，可以获取 10 美元的代金券，需要在 30 天之内使用，使用的条件就是充值 10 美元以上的钱。例如充值 10 美元就会获取 20 美元的帐号余额，这些钱如果购买 3.5 美元的主机可以使用半年了，挺划算的。</p><p>此外还有一个限时的大优惠，如果准备长期使用 <code>Vultr</code>，肯定要充值多一点，我这里有一个限时的推广链接：<a href="https://www.vultr.com/?ref=8421997-6G" target="_blank" rel="noopener">我的 25 美元推广链接 </a>，可以获取 100 美元的代金券，使用条件就是 <strong>充值 25 美元以上的金额 </strong>。假如充值了 25 美元，总共获取 100 美元入账【账号需要活跃 30 天】，购买 3.5 美元的主机可以使用 29 个月，适合长期使用 <code>Vultr</code> 的。</p><p>以下列举 <code>Vultr</code> 的五大好处：</p><ul><li><strong>扣费灵活 </strong>，<code>Vultr</code> 有一个好处就是主机的费用并不是按照月份扣除的，而是按照天扣除的，每天扣除的费用是 <strong>月租 / 30</strong>。例如你的主机只用了 10 天，然后销毁不用了，实际只会扣除月租 1/3 的钱，这种方式很是灵活，哪怕主机的 <code>IP</code> 地址被屏蔽了也可以销毁重新生成一个，并不会浪费钱。它不像国内的云服务商，一般是按照月份扣费的。</li><li><strong>主机管理灵活 </strong>，它不像国内的云服务商，购买一台云主机后，直接先扣费，然后分配一台主机，<code>IP</code> 地址是固定的，如果有问题只能重启。而在 <code>Vultr</code> 中是可以随意创建、销毁虚拟主机的，根据你自己的需求，选择配置、主机机房位置、操作系统，几分钟就可以生成一台主机，如果用了几天觉得不好，或者 <code>IP</code> 地址被封，再销毁重新创建即可，<code>Vultr</code> 只会扣除你几天的费用，非常人性化。</li><li><strong>价格优惠 </strong>，根据配置的不同，价格有多个档次，有 <code>$2.5 / 月</code>（只有 <code>IP6</code> 地址）、<code>$3.5 / 月</code>、<code>$5 / 月</code> 等等，更贵的也有，一般个人使用选择这三个中的一个就够用了，但是要注意便宜的经常售罄，而且最便宜的只支持 <code>IP6</code>，慎用。大家如果看到没有便宜的主机了不用着急，可以先买了贵的用着，反正费用是按照天数扣除的，等后续发现便宜的套餐赶紧购买，同时把贵的主机给销毁，不会亏钱的。</li><li><strong>付费方式灵活 </strong>，付费方式除了支持常见的 <strong>Paypal</strong>、<strong> 信用卡 </strong>等方式，它还支持 <strong>比特比 </strong>、<strong> 支付宝 </strong>、<strong> 微信 </strong>等方式。就问你是不是很人性化，作为一家国外的公司，还特意支持 <strong>支付宝 </strong>、<strong> 微信 </strong>的方式支付，也从侧面反映了随着中国的日益强大，中国的电子支付方式正在走向全球，越来越流行。</li><li><strong>机房分布全球 </strong>，它的机房位置遍布全球，例如 <strong>日本 </strong>、<strong> 新加坡 </strong>、<strong> 澳大利亚 </strong>、<strong> 美国 </strong>、<strong> 德国 </strong>、<strong> 英国 </strong>、<strong> 加拿大 </strong>，读者根据网络的需求可以灵活选择。</li></ul><p>关于 <code>Vultr</code> 云主机的生成以及 <code>Vultr</code> 系统的常用功能使用，由于不在这篇博客的介绍内容中，所以在此不再赘述。但是，我会在以后的某一天把它补充完整，并放上链接：<a href="https://www.playpi.org/2019072801.html">使用 Vultr 创建云主机详细步骤 </a>。</p><h1 id="Shadowsocks- 服务安装"><a href="#Shadowsocks- 服务安装" class="headerlink" title="Shadowsocks 服务安装"></a>Shadowsocks 服务安装</h1><p>下文中涉及的 <code>shadowsocks</code> 配置文件模板已经被我上传至 <code>GitHub</code>，读者可以提前下载参考：<a href="https://github.com/iplaypi/iplaypistudy/tree/master/iplaypistudy-normal/src/resource/20181116" target="_blank" rel="noopener">shadowsocks_conf</a> ，有两份，一份是单用户的【只开一个端口】，一份是多用户的【开多个端口】。</p><p>另外还有一份安装过程的总结文档：<code>shadowsocks_install_guide</code>，给有技术基础的读者使用，可以参考，按照步骤安装即可。</p><p>再说明一下，如果有技术零基础的读者不想折腾，就不用往下看了，可以直接参考我的另外一篇博客：<a href="https://www.playpi.org/2019082801.html">CentOS7 自动安装 Shadowsocks 脚本 </a>，只要下载对应的自动安装脚本，就可以一键运行、自动安装，不需要考虑是否有技术基础，边等边喝水，几分钟就会安装完成。</p><p>下面开始进入正题，详细描述 <code>shadowsocks</code> 服务的手动安装过程。</p><p>云主机选择 <code>CentOS 7 x64</code> 版本，全程操作使用 <code>Linux</code> 命令【注意，如果选择其它系统命令会不一致，请自己查询，例如：<code>Debian/Ubuntu</code> 系统的安装命令更简洁，先 <code>apt-get install python-pip</code>，再 <code>pip install shadowsocks</code> 即可】。</p><p>注意如果安装了防火墙【更安全】，需要的端口一定要开启，否则启动 <code>Shandowsocks</code> 会失败。</p><p>安装组件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install m2crypto python-setuptools</span><br><span class="line">easy_install pip</span><br><span class="line">pip install shadowsocks</span><br></pre></td></tr></table></figure><p>过程如图：</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa31ivc8mj21hc0mhdh5.jpg" alt="python-setuptools 安装" title="python-setuptools 安装"></p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3g9phq7j21hc0jb405.jpg" alt="pip 安装" title="pip 安装"></p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3h3eeyaj210k04edfx.jpg" alt="ss 安装" title="ss 安装"></p><p>配置服务器参数：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi  /etc/shadowsocks.json</span><br></pre></td></tr></table></figure><p>如下列出主要参数解释说明</p><table><thead><tr><th style="text-align:center">参数名称</th><th style="text-align:center">解释说明</th></tr></thead><tbody><tr><td style="text-align:center">server</td><td style="text-align:center">服务器地址，填 ip 或域名</td></tr><tr><td style="text-align:center">local_address</td><td style="text-align:center">本地地址</td></tr><tr><td style="text-align:center">local_port</td><td style="text-align:center">本地端口，一般 1080，可任意</td></tr><tr><td style="text-align:center">server_port</td><td style="text-align:center">服务器对外开的端口</td></tr><tr><td style="text-align:center">password</td><td style="text-align:center">密码，每个端口可以设置不同的密码</td></tr><tr><td style="text-align:center">port_password</td><td style="text-align:center">server_port + password ，服务器端口加密码的组合</td></tr><tr><td style="text-align:center">timeout</td><td style="text-align:center">超时重连</td></tr><tr><td style="text-align:center">method</td><td style="text-align:center">加密方法，默认：“aes-256-cfb”</td></tr><tr><td style="text-align:center">fast_open</td><td style="text-align:center">开启或关闭 <a href="https://github.com/shadowsocks/shadowsocks/wiki/TCP-Fast-Open" target="_blank" rel="noopener">TCP_FASTOPEN</a>，填 true /false，需要服务端支持</td></tr></tbody></table><p>配置多端口信息【多个帐号，多人也可用】：</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>: <span class="string">"你的 IP 地址"</span>（例如：<span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span>）,</span><br><span class="line">    <span class="attr">"local_address"</span>: <span class="string">"127.0.0.1"</span>（默认值）,</span><br><span class="line">    <span class="attr">"local_port"</span>:<span class="number">1080</span>（默认值）,</span><br><span class="line">    "port_password"（开启的端口和密码，自己按需配置，确保端口打开并不被其它程序占用）: &#123;</span><br><span class="line">        "1227": "pengfeivpn1227",</span><br><span class="line">        "1226": "pengfeivpn1226",</span><br><span class="line">        "1225": "pengfeivpn"</span><br><span class="line">    &#125;,</span><br><span class="line">    "timeout":300（超时时间，默认值）,</span><br><span class="line">    "method":"aes-256-cfb"（加密方法，默认值）,</span><br><span class="line">    "fast_open": false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置多端口信息【纯净版本，更改 <code>ip</code>、端口等信息直接复制使用】：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>: <span class="string">"x.x.x.x"</span>,</span><br><span class="line">    <span class="attr">"local_address"</span>: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"port_password"</span>: &#123;</span><br><span class="line">        <span class="attr">"1227"</span>: <span class="string">"vpn1227"</span>,</span><br><span class="line">        <span class="attr">"1226"</span>: <span class="string">"vpn1226"</span>,</span><br><span class="line">        <span class="attr">"1225"</span>: <span class="string">"vpn"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"aes-256-cfb"</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置一个端口信息【只有一个帐号，多人也可用】：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>:<span class="string">"你的 IP 地址"</span>（例如：<span class="number">192.168</span><span class="number">.0</span><span class="number">.1</span>）,  </span><br><span class="line">    <span class="attr">"server_port"</span>:<span class="number">1225</span>（唯一的端口）,</span><br><span class="line">    <span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"password"</span>:<span class="string">"pengfeivpn"</span>（唯一的密码）,</span><br><span class="line">    <span class="attr">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"aes-256-cfb"</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>:<span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>配置一个端口信息【纯净版本，更改 <code>ip</code>、端口等信息直接复制使用】：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"server"</span>:<span class="string">"x.x.x.x"</span>,  </span><br><span class="line">    <span class="attr">"server_port"</span>:<span class="number">1225</span>,</span><br><span class="line">    <span class="attr">"local_address"</span>:<span class="string">"127.0.0.1"</span>,</span><br><span class="line">    <span class="attr">"local_port"</span>:<span class="number">1080</span>,</span><br><span class="line">    <span class="attr">"password"</span>:<span class="string">"vpn"</span>,</span><br><span class="line">    <span class="attr">"timeout"</span>:<span class="number">300</span>,</span><br><span class="line">    <span class="attr">"method"</span>:<span class="string">"aes-256-cfb"</span>,</span><br><span class="line">    <span class="attr">"fast_open"</span>:<span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Shadowsocks</code> 性能优化：</p><p>另外还有很多参数可以优化性能，例如设置连接数、字节大小等，比较复杂，在此略过。</p><p>防火墙安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装防火墙 </span></span><br><span class="line">yum install firewalld</span><br><span class="line"><span class="comment"># 启动防火墙 </span></span><br><span class="line">systemctl start firewalld</span><br><span class="line"><span class="comment"># 查看目前已经开启的端口号 </span></span><br><span class="line">firewall-cmd --list-ports</span><br><span class="line"><span class="comment"># 端口号是你自己设置的端口 </span></span><br><span class="line">firewall-cmd --permanent --zone=public --add-port=1225/tcp</span><br><span class="line">firewall-cmd --permanent --zone=public --add-port=1226/tcp</span><br><span class="line">firewall-cmd --permanent --zone=public --add-port=1227/tcp</span><br><span class="line"><span class="comment"># 重载更新的端口信息 </span></span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><p>过程如图：</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3il37mlj20ka074dfy.jpg" alt="安装启动防火墙" title="安装启动防火墙"></p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3hxmaftj20jd04zmx6.jpg" alt="开启端口重载" title="开启端口重载"></p><p>这里需要注意，如果没安装防火墙，或者安装防火墙但是没有开启端口，启动 <code>Shadowsocks</code> 时会报错：<strong>socket.error: [Errno 98] Address already in use</strong>，启动失败，无法提供翻墙服务，而且不要被错误信息误导，不是端口被占用，是端口没有开启。</p><p>启动 <code>Shadowsocks</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 后台运行    </span></span><br><span class="line">ssserver -c /etc/shadowsocks.json -d start</span><br><span class="line"><span class="comment"># 调试时使用下面命令，实时查看日志 </span></span><br><span class="line">ssserver -c /etc/shadowsocks.json</span><br><span class="line"><span class="comment"># 停止运行    </span></span><br><span class="line">ssserver -c /etc/shadowsocks.json -d stop</span><br></pre></td></tr></table></figure><p>过程如图：</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3j16ymwj20hf03eglj.jpg" alt="启动 ss" title="启动 ss"></p><p>在使用 <strong>ssserver -c /etc/shadowsocks.json</strong> 查看启动日志时，发现除了正常的启动信息，还会有错误信息：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">INFO: loading config from /etc/shadowsocks.json</span><br><span class="line">2019-05-06 15:46:11 INFO     loading libcrypto from libcrypto.so.10</span><br><span class="line">2019-05-06 15:46:11 INFO     starting server at 66.42.105.87:1227</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;/usr/bin/ssserver&quot;, line 9, in &lt;module&gt;</span><br><span class="line">    load_entry_point (&apos;shadowsocks==2.8.2&apos;, &apos;console_scripts&apos;, &apos;ssserver&apos;)()</span><br><span class="line">  File &quot;/usr/lib/python2.7/site-packages/shadowsocks/server.py&quot;, line 68, in main</span><br><span class="line">    tcp_servers.append (tcprelay.TCPRelay (a_config, dns_resolver, False))</span><br><span class="line">  File &quot;/usr/lib/python2.7/site-packages/shadowsocks/tcprelay.py&quot;, line 582, in __init__</span><br><span class="line">    server_socket.bind (sa)</span><br><span class="line">  File &quot;/usr/lib64/python2.7/socket.py&quot;, line 224, in meth</span><br><span class="line">    return getattr (self._sock,name)(*args)</span><br><span class="line">socket.error: [Errno 98] Address already in use</span><br></pre></td></tr></table></figure><p>错误信息截图<br><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/2019/20190507000812.png" alt="错误信息截图" title="错误信息截图"></p><p>根据关键词 <strong>socket.error: [Errno 98] Address already in use</strong> 查阅资料，发现是主机的配置问题，停止的 <code>ss</code> 服务没有及时释放端口，导致启动时报错。但是我发现这种报错信息并没有影响到后台 <code>ss</code> 服务的正常启动，也就是说端口正常提供服务，可以顺利翻墙。同时，我按照其他人的解释说明，在 <strong>/etc/sysctl.conf</strong> 配置文件中增加了 <code>ip</code> 的配置：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_syncookies = 1 </span><br><span class="line">net.ipv4.tcp_tw_reuse = 1</span><br><span class="line">net.ipv4.tcp_tw_recycle = 1</span><br><span class="line">net.ipv4.tcp_fin_timeout = 5</span><br></pre></td></tr></table></figure><p>然后使用 <strong>/sbin/sysctl -p</strong> 命令让内核参数生效，结果在重启 <code>ss</code> 服务时看到日志里面还会有上面那种错误信息。后续考虑到这种现象并没有影响正常的服务，也就先不放在心上，专心做其它的工作。</p><h1 id="客户端使用"><a href="# 客户端使用" class="headerlink" title="客户端使用"></a>客户端使用</h1><h2 id="Windows- 平台使用"><a href="#Windows- 平台使用" class="headerlink" title="Windows 平台使用"></a>Windows 平台使用</h2><p>下载 <code>Windows</code> 平台的客户端，下载地址：<a href="https://github.com/shadowsocks/shadowsocks-windows" target="_blank" rel="noopener">shadowsocks-windows GitHub</a>，<a href="http://shadowsocks.org/en/download/clients.html" target="_blank" rel="noopener">shadowsocks 官网 </a>，直接解压放入文件夹即可使用，不需要安装。</p><p>但是注意配置内容【端口、密码、加密协议等等】，另外注意有些 <code>Windows</code> 系统缺失 <code>Shadowsocks</code> 必要的组件【<code>.NET Framework</code>】，需要安装，官网也有说明。</p><p>配置示例：</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa3pjtymuj20g60dp75k.jpg" alt="ss 配置" title="ss 配置"></p><p>实际上下载程序后，无需安装，直接解压即可，解压后只有一个 <code>exe</code> 文件，双击即可运行【最好放入指定文件夹中，便于程序管理和升级】。第一次启动，需要设置参数，如上图所示，至少配置一台机器，另外还可以设置开机启动，以后不用重新打开。此外，如果有更新版本的程序，会放在 <code>ss_win_temp</code> 文件夹下，直接解压后复制替换掉当前的 <code>exe</code> 文件即可；如果文件夹中有 <code>gui-config.json</code>、<code>statistics-config.json</code> 这 2 个文本文件，它们是程序的配置以及前面设置的翻墙配置，不能删掉；如果使用系统代理的 <code>PAC</code> 模式（推荐使用），会生成 <code>pac.txt</code> 文本文件，存放从 <code>GFWList</code> 获取的被墙的网址，必要时才会通过翻墙代理访问，其它正常的网址则直接访问，这样可以节约流量。</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3ly1fxbhx6e12jj20h004qgln.jpg" alt="ss 文件夹" title="ss 文件夹"></p><p>如果有切换代理的需求，搭配浏览器的插件来完成，例如 <a href="https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?hl=zh-CN" target="_blank" rel="noopener">Proxy SwitchyOmega</a> 就可以。</p><p>关于启动系统代理并使用 <code>PAC</code> 模式【根据条件过滤，不满足的直连】，如果是入门级别使用，直接设置完就可以用了，不用再管其它设置，切记要定时更新 <code>GFWList</code> 列表，因为如果某些网站最近刚刚被屏蔽，不在以前的 <code>HFWList</code> 列表里面，就会导致无法连接，只有及时更新才能正常连接。但是还有一种极端情况，就是某些网站 <code>GFWList</code> 迟迟没有收录，怎么更新都不会起作用，别着急，此时可以使用用户自定义规则，模仿 <code>GFWList</code> 填写自己的过滤规则，即可实现灵活的切换，使用用户自定义规则后会在安装文件夹中生成 <code>user-rule.txt</code> 文本文件。</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbo5moanxj20cj0a5dga.jpg" alt="开启系统代理并使用 PAC 模式" title="开启系统代理并使用 PAC 模式"></p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbo6rej96j20ip0axjs7.jpg" alt="PAC 模式下更新 GFWList 内容" title="PAC 模式下更新 GFWList 内容"></p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbo7ifow9j20j80apt9k.jpg" alt="PAC 模式下自定义过滤规则" title="PAC 模式下自定义过滤规则"></p><p>其实，<code>PAC</code> 模式的原理就是根据公共的过滤规则【收集被屏蔽的网站列表】，自动生成了一个脚本文件，把脚本文件绑定到浏览器的代理设置中，使浏览器访问网站前都会运行这个脚本，根据脚本的结果决定是直接访问还是通过本地代理访问，脚本在 <code>Shadowsocks</code> 的 <code>PAC</code> 设置中可以看到，浏览器的设置信息可以在代理设置中看到【浏览器在 <code>Shadowsocks</code> 开启系统代理的时候会自动设置代理，无需人工干预】。</p><p>由此可以得知，通过本机访问网络，决定是直接连接还是通过 <code>Shadowsocks</code> 代理连接的是 <code>PAC</code> 脚本，并不是 <code>Shadowsocks</code> 本身，所以如果使用系统的 <code>Ping</code> 命令访问 <a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a> 仍然是不能访问的，因为直接 <code>Ping</code> 没有经过 <code>PAC</code> 脚本，还是直接连接了，不可能访问成功。除了浏览器之外，如果其它程序也想访问被屏蔽的网站【例如 <code>Git</code>、<code>Maven</code> 仓库】，只能通过程序自己的代理设置进行配置，完成访问的目的。【如果放弃 <code>PAC</code> 模式，直接使用全局模式，则不需要配置任何信息，本机所有的网络请求会全部经过翻墙代理，当然这样做会导致流量消耗过大，并且国内的正常网站访问速度也会很慢】</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbof33m9dj20ij0aa0tl.jpg" alt="获取 PAC 的脚本地址" title="获取 PAC 的脚本地址"></p><p>获取到的 <code>PAC</code> 脚本地址为：<br><a href="http://127.0.0.1:1080/pac?t=20181118030355597&amp;secret=qZKsW49fDFezR4jJQtRDhUVPRqnFu6JC3Nc+vtXDb0g=" target="_blank" rel="noopener">http://127.0.0.1:1080/pac?t=20181118030355597&amp;secret=qZKsW49fDFezR4jJQtRDhUVPRqnFu6JC3Nc+vtXDb0g=</a></p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxboiacqtbj20se0kojse.jpg" alt="浏览器代理配置" title="浏览器代理配置"></p><p>以上是查看 <code>Chrome</code> 浏览器和 <code>IE</code> 浏览器的代理设置信息，对于 <code>Microsoft Edge</code>【<code>Windows 10</code> 自带的】浏览器来说，界面有点不一样，在 <strong>设置 </strong>-&gt; <strong>高级 </strong>-&gt; <strong>代理设置 </strong>里面。</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbooa2ikvj20xc0pwq93.jpg" alt="Edge 浏览器设置代理脚本" title="Edge 浏览器设置代理脚本"></p><p>此外，如果在浏览器中有更灵活的需求应用， 例如在设置多个代理的情况下，针对公司内网是一套，针对指定的几个网站是一套，针对被屏蔽的网站是一套，剩余的直接连接。在这种情况下仅仅使用代理脚本就不能完成需求了，显得场景很单一，当然也可以把脚本写的复杂一点，但是成本太高，而且不方便维护更新。这个时候就需要浏览器的插件出场了，例如在 <code>Chrome</code> 下我选择了 <a href="https://chrome.google.com/webstore/detail/proxy-switchyomega/padekgcemlokbadohgkifijomclgjgif?hl=zh-CN" target="_blank" rel="noopener">SwitchyOmega</a> 这个插件，可以设置多种情景模式，根据实际情况自由切换，非常方便。我设置了三种情景模式：<code>hdpProxy</code>【公司内网】、<code>shadowSocks</code>【翻墙代理】、<code>auto switch</code>【根据条件自动切换】，前面两种情景模式直接设置完成即可，最后的 <code>auto switch</code> 需要配置得复杂一点，根据正则表达式或者通配符指定某些网站的访问方式必须使用 <code>hdpProxy</code> 代理，另外其它的根据规则列表<br>【<a href="https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt" target="_blank" rel="noopener">https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt</a> ，和 <code>Shadowsocks</code> 的 <code>GFWList</code> 列表类似】必须通过翻墙代理，剩余的才是直接连接。当然，此时就不需要把 <code>Shadowsocks</code> 设置为系统代理了，保持 <code>Shadowsocks</code> 后台运行就可以了。</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxbp79ywuej21hc0q20v7.jpg" alt="SwitchyOmega 插件配置" title="SwitchyOmega 插件配置"></p><h2 id="Android- 平台使用"><a href="#Android- 平台使用" class="headerlink" title="Android 平台使用"></a>Android 平台使用</h2><p><code>Android</code> 平台的安装使用方法就非常简单了，分为 <strong>安装、配置、启动 </strong>这 3 个步骤，没有其它多余的操作。</p><h3 id="安装"><a href="# 安装" class="headerlink" title="安装"></a>安装</h3><p>下载 <code>Android</code> 平台的客户端，一般我们都称之为 <strong>影梭 </strong>，在应用商城是找不到的，因为通不过审核，所以只能去官网下载，下载地址：<a href="http://shadowsocks.org/en/download/clients.html" target="_blank" rel="noopener">shadowsocks 官网 </a>。切记，千万不要去第三方网站下载，因为下载的安装包可能带有其它的应用，导致给你的手机安装了一堆软件。当然，如果你连官网都不信，可以自己下载源代码，自己打包 <code>apk</code> 文件，也是可以的，懂一点点 <code>Android</code> 开发就行了，源代码全部是开源的，放在了 <code>GitHub</code> 上面：<a href="https://github.com/Jigsaw-Code/outline-client/" target="_blank" rel="noopener">https://github.com/Jigsaw-Code/outline-client/</a> 。</p><p>下载完 <code>apk</code> 文件，安装也就是和安装普通的应用一样，需要注意的是有些 <code>Android</code> 手机会禁止外部来源的 <code>app</code>【不是从应用商店下载安装的】安装，所以需要同意一下，也就是 <strong>信任此应用 </strong>，才能顺利完成安装。</p><h3 id="配置"><a href="# 配置" class="headerlink" title="配置"></a>配置</h3><p>需要配置的内容和 <code>Windows</code> 平台的一样，把那些必要的参数填进去就行了，其它内容不需要关心。例如我这里配置了 <code>ip</code>、端口、密码、加密方式等。<br><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1g0pzdu7hdhj20u01me0xa.jpg" alt="配置信息" title="配置信息"></p><h3 id="启动"><a href="# 启动" class="headerlink" title="启动"></a>启动</h3><p>启动只要点击右上角的灰色圆形按钮，里面有一个小飞机，大概等待几秒钟，就会变绿，表示已经连接上 <code>VPN</code> 了，此时手机就可以连接被屏蔽的网站了。唯一的缺点就是，不支持设置类似于 <code>PAC</code> 规则的站点切换【<strong> 路由 </strong>默认设置的是绕过中国大陆地址】，因为只要一连上 <code>VPN</code>，手机上所有的国外连接都是走 <code>VPN</code>，会导致连某些正常的国外的网站也会慢一点，还浪费 <code>VPS</code> 的流量。当然，如果是在 <code>WIFI</code> 的环境下，通过 <code>Android</code> 系统的网络代理设置也可以设置一些类似于 <code>PAC</code> 的规则，就不细说了。启动后，还可以看到流量发送接收统计信息。<br><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1g0pzebvxr7j20u01mcae9.jpg" alt="启动成功" title="启动成功"></p><p>在手机的设置里面也可以看到 <code>VPN</code> 的开启<br><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1g0pzegquf2j20u01jc0wu.jpg" alt="查看系统开启的 VPN" title="查看系统开启的 VPN"></p><h1 id="踩坑记录"><a href="# 踩坑记录" class="headerlink" title="踩坑记录"></a> 踩坑记录</h1><p>1、在云主机安装服务端后，又安装了防火墙，但是没有开启 <code>Shadowsocks</code> 需要的端口，导致启动 <code>Shadowsocks</code> 总是失败，但是报错信息又是 <code>Python</code> 和 <code>Linux</code> 的，看不懂，搜索资料也搜不到，后来重装，并且想清楚每一步骤是干什么的，会造成什么影响，通过排除法找到了根本原因。</p><p>2、在 <code>Windows</code> 平台使用的时候，安装了客户端，也安装了 <code>.NET Framework</code> 组件，配置信息确认无误，但是就是上不了外网，同样的操作使用 <code>Android</code> 客户端却可以，所以有理由怀疑是自己的主机问题。后来，重启系统，检查网络，关闭杀毒软件，还是不行，后来，依靠搜索，找到了是杀毒软件 <code>Avast</code> 的问题，扫描 <code>SSL</code> 连接被开启了，大坑，关闭即可。</p><p><img src="https://raw.githubusercontent.com/iplaypi/img-playpi/master/img/old/b7f2e3a3gy1fxa0mkrws7j20pc0nkglz.jpg" alt="Avast 截图"></p><p>3、参考：<a href="https://github.com/sirzdy/shadowsocks" target="_blank" rel="noopener"> 梯子搭建 </a>。</p><p>4、本来以为 <code>Shadowsocks</code> 的 <strong>启用系统代理 </strong>中的 <code>PAC</code> 模式会在接收到网络请求的基础上进行过滤，即 <code>Shadowsocks</code> 能控制所有的网络请求进行过滤判断，然后该翻墙的翻墙，该直连的直连。如果浏览器没有使用任何代理插件，类似于 <code>SwitchyOmega</code> 这种，还是可以自动根据 <code>PAC</code> 列表进行过滤的的，但是后来发现浏览器如果被代理插件给代理了，那么浏览器插件 <code>SwitchyOmega</code> 设置代理规则后，<code>PAC</code> 脚本就不会生效了，通过 <code>SwitchyOmega</code> 插件使用 <code>Shadowsocks</code> 代理的网站都直接翻墙，不会有任何关于 <code>PAC</code> 列表的判断。如果想拥有类似于 <code>PAC</code> 列表的判断，应该在 <code>Shadowsocks</code> 代理插件中好好配置，不应该交给 <code>Shadowsocks</code>。这也导致优酷视频消耗了大量的流量，而且速度还很慢。</p><p>这里面的根本原因就是 <code>PAC</code> 列表与 <code>SwitchyOmega</code> 代理插件的作用是类似的，都是为了区分网络请求，二者不可共存。如果谷歌浏览器安装了 <code>SwitchyOmega</code> 代理插件，但是 <code>IE</code> 浏览器没有安装，那么谷歌浏览器被 <code>SwitchyOmega</code> 代理，<code>IE</code> 浏览器还是按照 <code>PAC</code> 的规则来，都可以根据各自的网站规则进行访问。</p><p>另外，为了保证国内的网站不是经过翻墙代理，能直接连接，就不能使用 <code>Shadowsocks</code> 设置 <strong>系统代理模式 </strong>中的 <strong>全局模式 </strong>。</p><p>5、使用插件 <code>SwitchyOmega</code> 的过程中，一开始是自己整理一些规则，而没有使用<br><a href="https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt" target="_blank" rel="noopener">https://raw.githubusercontent.com/gfwlist/gfwlist/master/gfwlist.txt</a> 列表规则，导致配置信息很多，而且自己看着头都大，不好维护与查看，后来就发现了列表规则，解放了劳动力。</p><p>6、解决了 <code>Chrome</code> 浏览器的收藏跨平台自动更新同步的问题，以前在三台电脑之间添加取消收藏，总是不能更新同步，需要手动开启系统代理设置全局模式【<code>Chrome</code> 浏览器的收藏同步功能被屏蔽了，我又不知道 <code>url</code> 是什么】，等一会更新同步之后再关闭【防止其它场景也翻墙了】。目前使用规则列表，收藏可以自动更新同步了，不需要手动来回切换了，也不用担忘记同步的情况了。</p></div><div><div id="wechat_subscriber" style="display:block;padding:10px 0;margin:20px auto;width:100%;text-align:center"><img id="wechat_subscriber_qcode" src="/images/wechat-qr-personal.jpg" alt="虾丸派 wechat" style="width:200px;max-width:100%"><div>扫一扫添加博主，进技术交流群，共同学习进步</div></div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>永不止步</div><button id="rewardButton" disable="enable" onclick='var qr=document.getElementById("QR");"none"===qr.style.display?qr.style.display="block":qr.style.display="none"'><span>打赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/wechat-pay-playpi.png" alt="虾丸派 微信支付"><p>微信支付</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> 虾丸派</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://www.playpi.org/2018111601.html" title="使用 Vultr 搭建 Shadowsocks（VPS 搭建 SS）">https://www.playpi.org/2018111601.html</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Shadowsocks/" rel="tag"><i class="fa fa-tag"></i> Shadowsocks</a> <a href="/tags/Vultr/" rel="tag"><i class="fa fa-tag"></i> Vultr</a> <a href="/tags/VPS/" rel="tag"><i class="fa fa-tag"></i> VPS</a> <a href="/tags/Avast/" rel="tag"><i class="fa fa-tag"></i> Avast</a> <a href="/tags/shadowsocks-chn/" rel="tag"><i class="fa fa-tag"></i> 影梭</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2018110902.html" rel="next" title="Aria2 Web 管理面板使用"><i class="fa fa-chevron-left"></i> Aria2 Web 管理面板使用</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/2018111901.html" rel="prev" title="Google 账号开启两步验证与应用专用密码">Google 账号开启两步验证与应用专用密码 <i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div id="vcomments"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap">站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/favicon-1536x1536-playpi.png" alt="虾丸派"><p class="site-author-name" itemprop="name">虾丸派</p><p class="site-description motion-element" itemprop="description">记录知识 | 分享技术</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">144</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">13</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">294</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/iplaypi" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://weibo.com/u/3086148515" target="_blank" title="微博"><i class="fa fa-fw fa-weibo"></i>微博</a> </span><span class="links-of-author-item"><a href="mailto:playpi@qq.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" target="_blank" rel="external nofollow"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://github.com/iplaypi" title="GitHub" target="_blank" rel="external nofollow">GitHub</a></li><li class="links-of-blogroll-item"><a href="https://weibo.com/u/3086148515" title="Weibo" target="_blank" rel="external nofollow">Weibo</a></li><li class="links-of-blogroll-item"><a href="https://www.playpi.org" title="虾丸派" target="_blank" rel="external nofollow">虾丸派</a></li><li class="links-of-blogroll-item"><a href="https://www.playpi.org" title="playpi" target="_blank" rel="external nofollow">playpi</a></li><li class="links-of-blogroll-item"><a href="https://www.liaoxuefeng.com" title="廖雪峰" target="_blank" rel="external nofollow">廖雪峰</a></li><li class="links-of-blogroll-item"><a href="http://www.ruanyifeng.com" title="阮一峰" target="_blank" rel="external nofollow">阮一峰</a></li><li class="links-of-blogroll-item"><a href="https://travis-ci.org/iplaypi/iplaypi.github.io" title="travis-ci" target="_blank" rel="external nofollow">travis-ci</a></li><li class="links-of-blogroll-item"><a href="https://www.vultr.com/?ref=7861302-4F" title="Vultr" target="_blank" rel="external nofollow">Vultr</a></li></ul></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#主机购买"><span class="nav-number">1.</span> <span class="nav-text">主机购买</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Shadowsocks- 服务安装"><span class="nav-number">2.</span> <span class="nav-text">Shadowsocks 服务安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#客户端使用"><span class="nav-number">3.</span> <span class="nav-text">客户端使用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Windows- 平台使用"><span class="nav-number">3.1.</span> <span class="nav-text">Windows 平台使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Android- 平台使用"><span class="nav-number">3.2.</span> <span class="nav-text">Android 平台使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">3.2.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配置"><span class="nav-number">3.2.2.</span> <span class="nav-text">配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#启动"><span class="nav-number">3.2.3.</span> <span class="nav-text">启动</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#踩坑记录"><span class="nav-number">4.</span> <span class="nav-text">踩坑记录</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright">&copy; 2016&ndash;<span itemprop="copyrightYear">2021</span> <span class="post-meta-divider">|</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">虾丸派</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span class="post-meta-item-text">全站字数统计</span> <span title="全站字数统计">326.1k 字</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io" rel="external nofollow">Hexo</a> 强力驱动</div><span class="post-meta-divider">|</span><div class="theme-info">主题&nbsp;<a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next" rel="external nofollow">NexT.Mist</a><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-divider">|</span> 总访问量 <span id="busuanzi_value_site_pv"></span> 次 </span><span id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-divider">|</span> 总访客 <span id="busuanzi_value_site_uv"></span> 人</span></div><div class="busuanzi-count"><script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script><script src="//unpkg.com/valine@1.3.7/dist/Valine.min.js"></script><script type="text/javascript">new Valine({av:AV,el:"#comments",verify:!1,notify:!1,app_id:"FC5Jijeg1meo2K2OzPYWK327-gzGzoHsz",app_key:"6A1ReY8tjhPutK00F01YbJSq",placeholder:"没有问题吗？"})</script><script type="text/javascript">var isfetched=!1,isXml=!0,search_path="search.xml";0===search_path.length?search_path="search.xml":/json$/i.test(search_path)&&(isXml=!1);var path="/"+search_path,onPopupClose=function(t){$(".popup").hide(),$("#local-search-input").val(""),$(".search-result-list").remove(),$("#no-result").remove(),$(".local-search-pop-overlay").remove(),$("body").css("overflow","")};function proceedsearch(){$("body").append('<div class="search-popup-overlay local-search-pop-overlay"></div>').css("overflow","hidden"),$(".search-popup-overlay").click(onPopupClose),$(".popup").toggle();var t=$("#local-search-input");t.attr("autocapitalize","none"),t.attr("autocorrect","off"),t.focus()}var searchFunc=function(t,e,s){"use strict";$("body").append('<div class="search-popup-overlay local-search-pop-overlay"><div id="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div>').css("overflow","hidden"),$("#search-loading-icon").css("margin","20% auto 0 auto").css("text-align","center"),$.ajax({url:t,dataType:isXml?"xml":"json",async:!0,success:function(t){isfetched=!0,$(".popup").detach().appendTo(".header-inner");var o=isXml?$("entry",t).map(function(){return{title:$("title",this).text(),content:$("content",this).text(),url:$("url",this).text()}}).get():t,n=document.getElementById(e),r=document.getElementById(s),t=function(){var m=n.value.trim().toLowerCase(),x=m.split(/[\s\-]+/);1<x.length&&x.push(m);var e,w=[];0<m.length&&o.forEach(function(t){var e=!1,o=0,h=0,n=t.title.trim(),r=n.toLowerCase(),s=t.content.trim().replace(/<[^>]+>/g,""),a=s.toLowerCase(),i=decodeURIComponent(t.url),c=[],l=[];if(""!=n&&(x.forEach(function(t){function e(t,e,o){var n=t.length;if(0===n)return[];var r,s=0,a=[];for(o||(e=e.toLowerCase(),t=t.toLowerCase());-1<(r=e.indexOf(t,s));)a.push({position:r,word:t}),s=r+n;return a}c=c.concat(e(t,r,!1)),l=l.concat(e(t,a,!1))}),(0<c.length||0<l.length)&&(e=!0,o=c.length+l.length)),e){function p(t,e,o,n){for(var r=n[n.length-1],s=r.position,a=r.word,i=[],c=0;s+a.length<=o&&0!=n.length;){a===m&&c++,i.push({position:s,length:a.length});var l=s+a.length;for(n.pop();0!=n.length&&(s=(r=n[n.length-1]).position,a=r.word,s<l);)n.pop()}return h+=c,{hits:i,start:e,end:o,searchTextCount:c}}[c,l].forEach(function(t){t.sort(function(t,e){return e.position!==t.position?e.position-t.position:t.word.length-e.word.length})});t=[];0!=c.length&&t.push(p(0,0,n.length,c));for(var u=[];0!=l.length;){var f=l[l.length-1],d=f.position,g=f.word,v=d-20,f=d+80;v<0&&(v=0),(f=f<d+g.length?d+g.length:f)>s.length&&(f=s.length),u.push(p(0,v,f,l))}u.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hits.length!==e.hits.length?e.hits.length-t.hits.length:t.start-e.start});e=parseInt("1");function $(o,t){var n="",r=t.start;return t.hits.forEach(function(t){n+=o.substring(r,t.position);var e=t.position+t.length;n+='<b class="search-keyword">'+o.substring(t.position,e)+"</b>",r=e}),n+=o.substring(r,t.end)}0<=e&&(u=u.slice(0,e));var C="";0!=t.length?C+="<li><a href='"+i+"' class='search-result-title'>"+$(n,t[0])+"</a>":C+="<li><a href='"+i+"' class='search-result-title'>"+n+"</a>",u.forEach(function(t){C+="<a href='"+i+'\'><p class="search-result">'+$(s,t)+"...</p></a>"}),w.push({item:C+="</li>",searchTextCount:h,hitCount:o,id:w.length})}}),1===x.length&&""===x[0]?r.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x" /></div>':0===w.length?r.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>':(w.sort(function(t,e){return t.searchTextCount!==e.searchTextCount?e.searchTextCount-t.searchTextCount:t.hitCount!==e.hitCount?e.hitCount-t.hitCount:e.id-t.id}),e='<ul class="search-result-list">',w.forEach(function(t){e+=t.item}),r.innerHTML=e+="</ul>")};n.addEventListener("input",t),$(".local-search-pop-overlay").remove(),$("body").css("overflow",""),proceedsearch()}})};$(".popup-trigger").click(function(t){t.stopPropagation(),!1===isfetched?searchFunc(path,"local-search-input","local-search-result"):proceedsearch()}),$(".popup-btn-close").click(onPopupClose),$(".popup").click(function(t){t.stopPropagation()}),$(document).on("keyup",function(t){27===t.which&&$(".search-popup").is(":visible")&&onPopupClose()})</script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script><script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.3"></script><script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.3"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,debug:!1,model:{scale:1,jsonPath:"/live2dw/assets/hijiki.model.json"},display:{position:"left",width:100,height:200,hOffset:0,vOffset:-20},mobile:{show:!1,motion:!0,scale:.3},log:!1})</script></body></html>